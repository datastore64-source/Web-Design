<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Typing with Speech</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #111;
            color: #0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
            padding: 20px;
        }

        #output {
            font-size: 24px;
            border: 2px solid #0f0;
            padding: 20px;
            width: 80%;
            max-width: 700px;
            background: #000;
            white-space: pre-wrap;
            line-height: 1.5;
            margin-bottom: 20px;
            min-height: 160px;
            overflow-y: auto;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
        }

        button,
        select,
        input[type=range] {
            padding: 10px 15px;
            font-size: 16px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
        }

        button:hover {
            background: #1f1;
            color: #000;
        }
    </style>
</head>

<body>

    <div id="output"></div>

    <div class="controls">
        <button onclick="speakAndType()">‚ñ∂Ô∏è Speak & Type</button>
        <button onclick="resetOutput()">üîÑ Rewind</button>
        <button onclick="startContinuousSpeechToText()">üéß Continuous Speech-to-Text</button>
        <label>
            Voice:
            <select id="voiceSelect"></select>
        </label>
        <label>
            Typing Speed:
            <input type="range" id="speed" min="10" max="200" value="50">
        </label>
    </div>

    <script>
        const text = "Welcome to the futuristic typing effect demo. Words will appear as they are spoken.";
        const output = document.getElementById("output");
        const voiceSelect = document.getElementById("voiceSelect");
        const speedInput = document.getElementById("speed");

        let voices = [];
        let selectedVoice = null;

        function loadVoices() {
            voices = speechSynthesis.getVoices();
            voiceSelect.innerHTML = '';
            voices.forEach((voice, i) => {
                const option = document.createElement("option");
                option.value = i;
                option.textContent = `${voice.name} (${voice.lang})`;
                voiceSelect.appendChild(option);
            });
            selectedVoice = voices[0];
        }

        speechSynthesis.onvoiceschanged = loadVoices;

        async function typeText(str, delay = 50) {
            output.textContent = "";
            for (let i = 0; i < str.length; i++) {
                output.textContent += str[i];
                await new Promise(res => setTimeout(res, delay));
            }
        }

        function speakText(str) {
            return new Promise(resolve => {
                const utterance = new SpeechSynthesisUtterance(str);
                utterance.voice = selectedVoice;
                utterance.rate = 1;
                utterance.pitch = 1;
                utterance.volume = 1;
                utterance.onend = resolve;
                speechSynthesis.speak(utterance);
            });
        }

        async function speakAndType() {
            selectedVoice = voices[voiceSelect.value];
            const delay = parseInt(speedInput.value);
            await Promise.all([
                typeText(text, delay),
                speakText(text)
            ]);
        }

        function resetOutput() {
            output.textContent = "";
            speechSynthesis.cancel();
        }

        function startContinuousSpeechToText() {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = "en-US";
            recognition.interimResults = true;
            recognition.continuous = true;

            output.textContent = "üéß Listening...\n";
            recognition.start();

            recognition.onresult = function (event) {
                let transcript = '';
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    transcript += event.results[i][0].transcript + ' ';
                }
                output.textContent = transcript.trim();
            };

            recognition.onerror = function (event) {
                output.textContent += "\n‚ùå Error: " + event.error;
            };

            recognition.onend = () => {
                recognition.start(); // restart for continuous mode
            };
        }
    </script>

</body>

</html>